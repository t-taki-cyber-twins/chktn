# MCP利用ガイド

## 概要

- **Serena MCP**: プロジェクト内のコードを構造的に理解・編集するためのツール
- **Context7 MCP**: 外部ライブラリの最新ドキュメントを取得するためのツール

## Serena MCP

### 役割
プロジェクト内のコードを**シンボル（クラス、メソッド、関数など）単位**で効率的に操作する。

### 主要機能
- **コード検索**: `get_symbols_overview`, `find_symbol`, `find_referencing_symbols`, `search_for_pattern`
- **コード編集**: `replace_symbol_body`, `insert_after_symbol`, `insert_before_symbol`, `rename_symbol`
- **プロジェクト管理**: `write_memory`, `read_memory`, `list_memories`, `list_dir`, `find_file`

### 使用すべきタイミング
- セマンティック理解のため: シンボル参照、依存関係追跡、LSP統合
- プロジェクト内のコードを理解・編集するとき
- シンボル（クラス、メソッド）を検索・操作するとき
- ファイル全体を読み込まずに効率的にコードを扱いたいとき
- コードの参照関係を調べたいとき
- プロジェクト固有の情報をメモリとして保持したいとき
- 大規模コードベースの分析

### 重要な原則
- **ファイル全体を読み込む前にシンボルツールを使用**: 必要な部分だけを操作してトークン消費を抑える
- **シンボルベースの操作を優先**: `replace_symbol_body`などのシンボルベースの操作を使用し、ファイル全体の編集は避ける

## Context7 MCP

### 役割
**外部ライブラリの最新ドキュメント**を取得する。

### 主要機能
- **`resolve-library-id`**: ライブラリ名からContext7互換のライブラリIDを解決
- **`get-library-docs`**: ライブラリのドキュメントを取得（特定トピックに焦点を当てることも可能）

### 使用すべきタイミング
- 外部ライブラリ（Spring Boot、PostgreSQL等）の使用方法を調べたいとき
- ライブラリの最新ドキュメントやAPIリファレンスが必要なとき
- ライブラリの特定機能やクラスの使い方を確認したいとき
- プロジェクト外の情報が必要なとき

### 重要な原則
- **まずライブラリIDを解決する**: `get-library-docs`を使用する前に、必ず`resolve-library-id`でライブラリIDを解決する
- **トピックを指定する**: 必要に応じて`topic`パラメータを指定して、関連するドキュメントのみを取得する

## まとめ

### ベストプラクティス
1. **状況を把握**: 何を知りたいか、何をしたいかを明確にする
2. **適切なツールを選択**: プロジェクト内の情報ならSerena、外部ライブラリならContext7
3. **組み合わせて使用**: 両方のツールを組み合わせて、より深く理解する
4. **効率を重視**: ファイル全体を読み込まず、必要な情報だけを取得する
