# メッセージ返信フォームモーダル (app-message-reply.js)

## 概要
メッセージスレッドへの返信や新規メッセージの作成を行うためのフォームモーダルコンポーネントです。件名と本文を入力し、社内通知メールの送信オプションを設定できます。

## 機能の目的
- メッセージへの返信を簡単に行えるようにする。
- 社内メンバーへの通知を任意で送信できるようにする。
- 送信前にメール内容をプレビュー確認できるようにする。

## ユースケース
- **メッセージへの返信**: ユーザーが既存のメッセージスレッドに対して返信を作成し送信する。
- **新規メッセージの作成**: ユーザーが新しいメッセージスレッドを開始する。
- **メールプレビュー**: ユーザーが送信前にメール内容を最終確認する。
- **社内通知**: ユーザーが社内メンバーにもメッセージ送信を通知する。

## EARS 記法による要件定義

### フォーム表示
- **WHEN** システムが返信モードでモーダルを開いた際
  - **THEN** システムはタイトルを「返信」とし、件名に「RE:」を付加する
  - **IF** 元の件名に既に「RE:」が含まれている場合
    - **THEN** 重複して付加しない
- **WHEN** システムが新規作成モードでモーダルを開いた際
  - **THEN** システムはタイトルを「新規メッセージ」とし、件名をクリアする

### 入力・送信
- **WHEN** ユーザーが必須項目（件名、本文）を入力せずに送信ボタンをクリックした際
  - **THEN** システムはバリデーションエラーを表示する
- **WHEN** ユーザーが有効な内容で送信ボタンをクリックした際
  - **THEN** システムは返信データ（スレッドID、件名、本文、社内通知フラグ）をイベントで通知する
  - **AND** モーダルを閉じる

### プレビュー
- **WHEN** ユーザーが「メールプレビュー」ボタンをクリックした際
  - **THEN** システムはメールプレビューモーダル（`app-email-preview`）を開く
  - **AND** 入力された件名と本文を表示する

## 機能一覧

| コンポーネント | 機能名 | 概要 | 優先度 | アクター | 備考 |
|---|---|---|---|---|---|
| app-message-reply | 返信フォーム表示 | 件名・本文の入力フォームを表示する | 必須 | システム | |
| app-message-reply | 件名自動生成 | 返信モード時に「RE:」を自動付加する | 必須 | システム | |
| app-message-reply | バリデーション | 必須項目の入力チェックを行う | 必須 | システム | |
| app-message-reply | 送信処理 | 入力内容をイベントで親コンポーネントに通知する | 必須 | ユーザー | |
| app-message-reply | メールプレビュー | 送信前にメール内容を確認できる | 必須 | ユーザー | `app-email-preview`を使用 |
| app-message-reply | 社内通知オプション | 社内通知メール送信のチェックボックス | 必須 | ユーザー | |

## ユーザ確認事項
- **社内通知メールの宛先**: 社内通知メールの具体的な送信先（メーリングリスト、担当者等）の仕様確認が必要です。
- **プレビューからの送信**: 現在プレビューモーダルから直接送信する機能がコメントアウトされていますが、この機能の必要性について確認が必要です。
