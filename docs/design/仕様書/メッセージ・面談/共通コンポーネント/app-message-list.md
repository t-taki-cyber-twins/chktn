# メッセージ一覧コンポーネント (app-message-list.js)

## 概要
メッセージスレッドの一覧を表示し、新規作成、返信、詳細確認などのアクションを提供するコンポーネントです。案件詳細やエンジニア詳細画面などで、関連するメッセージのやり取りを表示するために使用されます。

## 機能の目的
- 関連するメッセージをスレッド形式で整理して表示し、経緯を追いやすくする。
- メッセージに対する主要なアクション（新規作成、返信、全件表示）へのアクセスを提供する。

## ユースケース
- **メッセージ履歴の確認**: ユーザーが案件やエンジニアの詳細画面で、過去のやり取りを確認する。
- **新規メッセージの作成**: ユーザーが「新規追加」または「問い合わせ」ボタンから新しいスレッドを開始する。
- **メッセージへの返信**: ユーザーが特定のスレッドに対して返信を行う。
- **スレッド詳細の確認**: ユーザーがスレッド内の全てのメッセージを確認するために「全て表示」を選択する。

## EARS 記法による要件定義

### 一覧表示
- **WHEN** コンポーネントが初期化されデータが渡された際
  - **THEN** システムはメッセージスレッドの一覧を表示する
  - **AND** 各スレッドの親メッセージと最新の子メッセージ（存在する場合）を表示する

### 詳細展開
- **WHEN** ユーザーがスレッドの親メッセージをクリックした際
  - **THEN** システムは詳細エリアを展開または折りたたむ
  - **IF** 展開された場合
    - **THEN** システムはメッセージの詳細内容をロードして表示する

### アクション実行
- **WHEN** ユーザーが「新規追加」または「問い合わせ」ボタンをクリックした際
  - **THEN** システムは新規メッセージ作成イベント（`message-new`）を発火する
- **WHEN** ユーザーが「返信」ボタンをクリックした際
  - **THEN** システムは返信イベント（`message-reply`）を発火し、スレッドID等の情報を渡す
- **WHEN** ユーザーが「全て表示」ボタンをクリックした際
  - **THEN** システムは全件表示イベント（`message-show-all`）を発火する

## 機能一覧

| コンポーネント | 機能名 | 概要 | 優先度 | アクター | 備考 |
|---|---|---|---|---|---|
| app-message-list | スレッド一覧表示 | 親メッセージと最新の返信を表示する | 必須 | システム | |
| app-message-list | 詳細展開・折りたたみ | クリックでメッセージ本文を展開表示する | 必須 | ユーザー | 動的ロード対応 |
| app-message-list | 新規作成ボタン | 新規メッセージ作成イベントを発火する | 必須 | ユーザー | 属性により表示制御可 |
| app-message-list | 問い合わせボタン | 問い合わせ作成イベントを発火する | 必須 | ユーザー | 属性により表示制御可 |
| app-message-list | 返信ボタン | 返信イベントを発火する | 必須 | ユーザー | |
| app-message-list | 全て表示ボタン | スレッド全件表示イベントを発火する | 必須 | ユーザー | 子メッセージがある場合のみ表示 |

## ユーザ確認事項
- **ページネーション**: 現在のコンポーネントにはページネーション機能が含まれていません。スレッド数が多い場合の挙動（無限スクロールか、ページ切り替えか）について確認が必要です。
- **ボタンの使い分け**: 「新規追加」と「問い合わせ」ボタンの使い分け（コンテキストによる出し分け）が属性で制御されていますが、具体的な運用ルールの確認が必要です。
