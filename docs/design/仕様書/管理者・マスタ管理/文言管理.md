# テキスト・テンプレート管理画面 (text-value-management.html)

## 概要
システムで使用するテキスト値（部署名、役職名、ステータス等）とテンプレート（メモやメール文言の雛形）を管理する画面です。2つのタブで構成され、統一された文言管理を実現します。

## 機能の目的
- システム全体で使用する文言（ラベル、選択肢等）を一元管理し、表記の統一を図る。
- メモやメール送信時に利用できるテンプレートを管理し、業務効率を向上させる。
- テナントごとにカスタマイズ可能な文言を提供し、組織の独自性に対応する。

## ユースケース
- **部署名・役職名の管理**: システム管理者は、社員情報や組織図で使用する部署名・役職名を登録・管理する。
- **ステータス文言の追加**: システム管理者は、エンジニアステータスや案件ステータスの選択肢を追加・編集する。
- **テンプレートの作成**: ユーザーは、案件メモやエンジニアメモで使用する定型文のテンプレートを作成する。
- **テンプレートの利用**: ユーザーは、メモ作成時にテンプレートを選択し、変数を埋め込んで迅速に文書を作成する。
- **AI生成テンプレートの活用**: ユーザーは、AI生成機能を利用したテンプレート変数（例: `{{AI生成:案件経歴}}`）を活用する。

## EARS 記法による要件定義

### タブ1: テキスト値管理

#### テキスト値検索・一覧表示
- **WHEN** ユーザーが「テキスト値管理」タブを開いた際
  - **THEN** システムはすべてのテキスト値を一覧表示する
  - **AND** カテゴリ、キー、値、説明を表示する

- **WHEN** ユーザーが検索条件（キーワード、カテゴリ）を入力して検索を実行した際
  - **THEN** システムは条件に一致するテキスト値のみをフィルタリングして表示する
  - **IF** キーワードが入力されている場合
    - **THEN** システムはキーまたは値に部分一致するテキスト値を表示する

#### テキスト値CRUD操作
- **WHEN** ユーザーが「新規作成」ボタンをクリックした際
  - **THEN** システムはテキスト値作成フォームを表示する
  - **AND** カテゴリ、キー、値、説明の入力を受け付ける

- **WHEN** ユーザーが「編集」ボタンをクリックした際
  - **THEN** システムは該当するテキスト値の編集フォームを表示する
  - **AND** 既存のテキスト値情報をフォームにロードする

- **WHEN** ユーザーが「削除」ボタンをクリックした際
  - **THEN** システムは確認ダイアログを表示する
  - **IF** ユーザーが削除を確認した場合
    - **AND IF** 該当テキスト値が他の機能で使用されている場合
      - **THEN** システムは警告メッセージを表示し、削除の影響を確認する
    - **ELSE**
      - **THEN** システムはテキスト値を削除する

### タブ2: テンプレート管理

#### テンプレート検索・一覧表示
- **WHEN** ユーザーが「テンプレート管理」タブを開いた際
  - **THEN** システムはすべてのテンプレートを一覧表示する
  - **AND** テンプレート名、カテゴリ、本文（一部）、使用されている変数を表示する

- **WHEN** ユーザーがテンプレート名やカテゴリで検索を実行した際
  - **THEN** システムは検索条件に一致するテンプレートのみをフィルタリングして表示する

#### テンプレートCRUD操作
- **WHEN** ユーザーが「新規作成」ボタンをクリックした際
  - **THEN** システムはテンプレート作成フォームを表示する
  - **AND** テンプレート名、カテゴリ、本文の入力を受け付ける
  - **AND** 利用可能な変数の一覧を表示する

- **WHEN** ユーザーがテンプレート本文に`{{変数名}}`形式で変数を記述した際
  - **THEN** システムは変数を解析し、「使用されている変数」に表示する
  - **IF** 変数が`{{AI生成:項目名}}`形式の場合
    - **THEN** システムはAI生成機能を利用するための変数として認識する

- **WHEN** ユーザーが「編集」ボタンをクリックした際
  - **THEN** システムは該当するテンプレートの編集フォームを表示する
  - **AND** 既存のテンプレート情報をフォームにロードする

- **WHEN** ユーザーが「削除」ボタンをクリックした際
  - **THEN** システムは確認ダイアログを表示する
  - **IF** ユーザーが削除を確認した場合
    - **THEN** システムはテンプレートを削除する

### 共通機能

#### タブ切り替え
- **WHEN** ユーザーがタブボタンをクリックした際
  - **THEN** システムは該当するタブの内容を表示する
  - **AND** サイドバーの検索フォームも該当するタブ用のものに切り替える
  - **AND** アクティブなタブを視覚的に強調表示する

## 機能一覧

| 画面 | 機能名 | 概要 | 優先度 | アクター | 備考 |
|---|---|---|---|---|---|
| テキスト値管理（タブ1） | テキスト値検索 | キーワード、カテゴリで検索する | 必須 | ユーザー | キーまたは値での部分一致検索 |
| テキスト値管理（タブ1） | テキスト値一覧表示 | すべてのテキスト値をテーブル形式で表示する | 必須 | システム | カテゴリ、キー、値、説明を表示 |
| テキスト値管理（タブ1） | テキスト値新規作成 | 新しいテキスト値を作成する | 必須 | ユーザー | 作成フォームの実装方法要確認 |
| テキスト値管理（タブ1） | テキスト値編集 | 既存テキスト値の情報を編集する | 必須 | ユーザー | 編集フォームの実装方法要確認 |
| テキスト値管理（タブ1） | テキスト値削除 | テキスト値を削除する | 必須 | ユーザー | 使用チェックと確認ダイアログ |
| テキスト値管理（タブ1） | ページネーション | ページ切り替えを行う | 必須 | ユーザー | `app-pagination`コンポーネントを使用 |
| テンプレート管理（タブ2） | テンプレート検索 | テンプレート名、カテゴリで検索する | 必須 | ユーザー | |
| テンプレート管理（タブ2） | テンプレート一覧表示 | すべてのテンプレートをテーブル形式で表示する | 必須 | システム | テンプレート名、カテゴリ、本文、変数を表示 |
| テンプレート管理（タブ2） | テンプレート新規作成 | 新しいテンプレートを作成する | 必須 | ユーザー | 作成フォームの実装方法要確認 |
| テンプレート管理（タブ2） | テンプレート編集 | 既存テンプレートの情報を編集する | 必須 | ユーザー | 編集フォームの実装方法要確認 |
| テンプレート管理（タブ2） | テンプレート削除 | テンプレートを削除する | 必須 | ユーザー | 確認ダイアログ |
| テンプレート管理（タブ2） | 変数解析・表示 | テンプレート本文から変数を抽出して表示する | 必須 | システム | `{{変数名}}`形式を解析 |
| テンプレート管理（タブ2） | AI生成変数対応 | `{{AI生成:項目名}}`形式の変数を認識する | 推奨 | システム | AI機能との連携要確認 |
| テンプレート管理（タブ2） | ページネーション | ページ切り替えを行う | 必須 | ユーザー | `app-pagination`コンポーネントを使用 |
| テキスト・テンプレート管理（共通） | タブ切り替え | 2つのタブ間で切り替える | 必須 | ユーザー | サイドバー検索フォームも連動 |

## ユーザ確認事項
- **テキスト値の利用箇所**: 各カテゴリのテキスト値（部署名、役職名、ステータス等）が具体的にどの画面・機能で使用されるかの確認が必要です。
- **テナント独自のカスタマイズ**: テキスト値やテンプレートはテナントごとにカスタマイズ可能か、それともシステム全体で共通かの確認が必要です。
- **変数の種類**: テンプレートで使用できる変数の種類や命名規則、利用可能な変数の一覧の確認が必要です。
- **AI生成機能**: `{{AI生成:項目名}}`形式の変数がどのように動作するか（AI APIとの連携方法、生成される内容等）の確認が必要です。
- **テンプレートのインポート/エクスポート**: テンプレートを他のテナントと共有したり、外部ファイルからインポート/エクスポートする機能の必要性について確認が必要です。
- **フォームの実装方法**: テキスト値、テンプレートの作成・編集フォームをモーダル、別画面、インライン編集のいずれで実装するか確認が必要です。
- **本文の表示**: テンプレート一覧での本文表示は、どの程度の長さまで表示するか（省略の基準）の確認が必要です。
- **ページネーション仕様**: 各タブで1ページあたりの表示件数や、サーバーサイドページネーションの実装方法について確認が必要です。
